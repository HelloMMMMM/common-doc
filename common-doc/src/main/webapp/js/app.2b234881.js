(function(t){function e(e){for(var o,i,s=e[0],c=e[1],u=e[2],d=0,f=[];d<s.length;d++)i=s[d],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(t[o]=c[o]);l&&l(e);while(f.length)f.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(o=!1)}o&&(r.splice(e--,1),t=i(i.s=n[0]))}return t}var o={},a={app:0},r=[];function i(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=o,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var o=n("85ec"),a=n.n(o);a.a},"10d9":function(t,e,n){},"15dd":function(t,e,n){"use strict";var o=n("bdf7"),a=n.n(o);a.a},"25f7":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),a=(n("0fae"),n("5c96")),r=function(t){t.use(a["Input"]),t.use(a["Icon"]),t.use(a["Row"]),t.use(a["Col"]),t.use(a["Upload"]),t.use(a["Card"]),t.use(a["Backtop"]),t.use(a["Loading"].directive),t.prototype.$prompt=a["MessageBox"].prompt,t.prototype.$message=a["Message"]},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("el-backtop"),n("el-row",[n("el-col",{attrs:{span:20,offset:2}},[n("div",[n("span",{class:t.docButtonStyle,on:{click:function(e){return t.navButtonClick(!1)}}},[t._v("文档")]),n("span",{class:t.editButtonStyle,on:{click:function(e){return t.navButtonClick(!0)}}},[t._v("编辑")])])])],1),n("el-row",[n("el-col",{attrs:{span:20,offset:2}},[t.isEdit?n("DocEdit"):n("DocView")],1)],1)],1)},s=[],c=window.sessionStorage;function u(t){c.setItem("isVerify",t)}function l(){return c.getItem("isVerify")}var d,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"main-content",attrs:{shadow:"always"}},[t.doc?n("Viewer",{attrs:{content:t.doc}}):t._e()],1)},p=[],h=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},m=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"viewer",attrs:{id:"viewer"}},[n("textarea")])}],v={props:{content:{type:String,default:""}},data:function(){return{viewer:null}},mounted:function(){var t=this;this.$nextTick((function(){var e=t;t.viewer=editormd.markdownToHTML("viewer",{width:"100%",autoHeight:!0,path:"/mdeditor/lib/",markdown:e.content,emoji:!0,tex:!0,flowChart:!0,sequenceDiagram:!0})}))}},g=v,b=(n("15dd"),n("2877")),y=Object(b["a"])(g,h,m,!1,null,null,null),w=y.exports,k={components:{Viewer:w},data:function(){return{doc:null}},methods:{getDoc:function(){var t=this;this.$post(this.$api.getDoc,{}).then((function(e){"ok"===e.data.state&&(t.doc=e.data.doc)})).catch((function(t){console.log(t)}))}},mounted:function(){this.getDoc()}},$=k,_=(n("6cd6"),Object(b["a"])($,f,p,!1,null,null,null)),D=_.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"main-content",attrs:{shadow:"always"}},[t.content?n("Editor",{attrs:{content:t.content}}):t._e()],1)},E=[],S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),n("el-upload",{staticClass:"editor-uploader",attrs:{action:this.$api.base+this.$api.upload,"show-file-list":!1,"on-success":t.handleImageSuccess,"before-upload":t.beforeImageUpload,data:t.uploadImageData}},[n("el-button",{attrs:{slot:"trigger",id:"uploader"},slot:"trigger"})],1)],1)},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"editor"}},[n("textarea")])}],B=(n("a9e3"),{name:"editor",props:{placeholder:{type:String,default:""},content:{type:String,default:""},targetId:{type:Number,default:0},uploadType:{type:Number,default:0}},data:function(){return{editor:null,uploadImageData:{adminId:0,token:null,targetId:0,type:0}}},methods:{initData:function(){this.uploadImageData.targetId=this.targetId,this.uploadImageData.type=this.uploadType},initEditor:function(){var t=this;this.$nextTick((function(){var e=t;e.editor=editormd("editor",{readOnly:e.readOnly,watch:!0,toolbar:!0,placeholder:e.placeholder,markdown:e.content,width:"100%",height:600,toolbarIcons:function(){return["undo","redo","|","bold","del","italic","quote","ucwords","uppercase","lowercase","h1","h2","h3","h4","h5","h6","list-ol","list-ul","hr","|","customimage","image","link","reference-link","datetime","html-entities","emoji","code","preformatted-text","code-block","table","pagebreak","|","goto-line","search","clear","|","watch","preview","|","save"]},toolbarIconsClass:{customimage:"fa-image",save:"fa-save"},lang:{toolbar:{customimage:"本地上传",image:"远程图片",save:"保存"}},toolbarHandlers:{customimage:function(){e.openUploader()},save:function(){e.saveDoc()}},autoFocus:!1,path:"/mdeditor/lib/",syncScrolling:!0,searchReplace:!0,emoji:!0,tex:!0,flowChart:!0,sequenceDiagram:!0,imageUpload:!1,toolbarAutoFixed:!0,onload:function(){this.width("100%"),this.watch()},onchange:function(){},onfullscreenExit:function(){this.width("100%")}})}))},openUploader:function(){var t=document.getElementById("uploader");t.click()},beforeImageUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,n=t.size/1024/1024<=1;return e||this.$message.error("图片只能是 JPG/PNG 格式"),n||this.$message.error("图片大小不能超过 1MB"),e&&n},handleImageSuccess:function(t){"fail"===t.state?this.$message.error(t.msg):this.insertToMarkdown(t.image)},insertToMarkdown:function(t){var e="![]("+t+")\n\n";this.editor.insertValue(e)},saveDoc:function(){var t=this;this.$post(this.$api.saveDoc,{content:this.editor.getMarkdown()}).then((function(e){"ok"===e.data.state&&t.$message.success("保存成功")})).catch((function(t){console.log(t)}))}},mounted:function(){this.initData(),this.initEditor()}}),O=B,j=(n("b16a"),Object(b["a"])(O,S,I,!1,null,null,null)),C=j.exports,M={components:{Editor:C},data:function(){return{content:null}},methods:{getDoc:function(){var t=this;this.$post(this.$api.getDoc,{}).then((function(e){"ok"===e.data.state&&(t.content=e.data.doc)})).catch((function(t){console.log(t)}))}},mounted:function(){this.getDoc()}},V=M,T=Object(b["a"])(V,x,E,!1,null,null,null),P=T.exports,U={components:{DocView:D,DocEdit:P},data:function(){return{isEdit:!1,pwd:null,docButtonStyle:"nav-button nav-button-color-selected",editButtonStyle:"nav-button nav-button-color-normal"}},methods:{navButtonClick:function(t){t?this.verify():(this.isEdit=t,this.docButtonStyle="nav-button nav-button-color-selected",this.editButtonStyle="nav-button nav-button-color-normal")},verify:function(){l()?this.toEdit():this.showVerifyDialog()},showVerifyDialog:function(){var t=this;this.$prompt("验证","编辑权限验证",{confirmButtonText:"确认",cancelButtonText:"取消",inputPlaceholder:"请输入密码",inputValue:null,inputValidator:this.inputValidatorWhenVerify}).then((function(e){var n=e.value;t.pwd=n,t.verifyRequest()})).catch((function(){}))},inputValidatorWhenVerify:function(t){if(!t)return"密码不可为空"},verifyRequest:function(){var t=this;this.$post(this.$api.verify,{pwd:this.pwd}).then((function(e){"ok"===e.data.state&&(t.toEdit(),u(!0))})).catch((function(t){console.log(t)}))},toEdit:function(){this.isEdit=!0,this.docButtonStyle="nav-button nav-button-color-normal",this.editButtonStyle="nav-button nav-button-color-selected"}}},R=U,q=(n("034f"),Object(b["a"])(R,i,s,!1,null,null,null)),L=q.exports,N=(n("10d9"),n("8058")),J={base:N.BASE_URL,getDoc:"getDoc",saveDoc:"saveDoc",upload:"upload",verify:"verify"},A=(n("99af"),n("d3b7"),n("bc3a")),H=n.n(A),F=J.base;H.a.defaults.withCredentials=!0,H.a.interceptors.request.use((function(t){return d=a["Loading"].service({spinner:"el-icon-loading",text:"Loading...",background:"rgba(0, 0, 0, 0.5)",lock:!0}),t}),(function(t){return d.close(),Promise.resolve(t)})),H.a.interceptors.response.use((function(t){return d.close(),"fail"===t.data.state&&a["Message"].error(t.data.msg),t}),(function(t){return d.close(),t.response?500===t.response.status?a["Message"].error("服务器错误"):404===t.response.status&&a["Message"].error("无此页面或接口"):"Network Error"===t.message?a["Message"].error("网络错误"):a["Message"].error("未知错误"),Promise.resolve(t)}));var G=function(t,e){return H()({method:"post",url:"".concat(F).concat(t),data:e,transformRequest:[function(t){var e="";for(var n in t)e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n])+"&";return e}],headers:{"Content-Type":"application/x-www-form-urlencoded"}})};o["default"].use(r),o["default"].prototype.$api=J,o["default"].prototype.$post=G,new o["default"]({render:function(t){return t(L)}}).$mount("#app")},"6cd6":function(t,e,n){"use strict";var o=n("d85a"),a=n.n(o);a.a},8058:function(t){t.exports=JSON.parse('{"BASE_URL":"http://localhost/api/"}')},"85ec":function(t,e,n){},b16a:function(t,e,n){"use strict";var o=n("25f7"),a=n.n(o);a.a},bdf7:function(t,e,n){},d85a:function(t,e,n){}});
//# sourceMappingURL=app.2b234881.js.map